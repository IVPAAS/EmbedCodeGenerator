/*! Kaltura Embed Code Generator - v1.0.0 - 2013-02-01
* https://github.com/kaltura/EmbedCodeGenerator
* Copyright (c) 2013 Ran Yefet; Licensed MIT */
this.Handlebars={},function(e){e.VERSION="1.0.rc.2",e.helpers={},e.partials={},e.registerHelper=function(e,t,n){n&&(t.not=n),this.helpers[e]=t},e.registerPartial=function(e,t){this.partials[e]=t},e.registerHelper("helperMissing",function(e){if(arguments.length===2)return undefined;throw new Error("Could not find property '"+e+"'")});var t=Object.prototype.toString,n="[object Function]";e.registerHelper("blockHelperMissing",function(r,i){var s=i.inverse||function(){},o=i.fn,u="",a=t.call(r);return a===n&&(r=r.call(this)),r===!0?o(this):r===!1||r==null?s(this):a==="[object Array]"?r.length>0?e.helpers.each(r,i):s(this):o(r)}),e.K=function(){},e.createFrame=Object.create||function(t){e.K.prototype=t;var n=new e.K;return e.K.prototype=null,n},e.logger={DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,methodMap:{0:"debug",1:"info",2:"warn",3:"error"},log:function(t,n){if(e.logger.level<=t){var r=e.logger.methodMap[t];typeof console!="undefined"&&console[r]&&console[r].call(console,n)}}},e.log=function(t,n){e.logger.log(t,n)},e.registerHelper("each",function(t,n){var r=n.fn,i=n.inverse,s=0,o="",u;n.data&&(u=e.createFrame(n.data));if(t&&typeof t=="object")if(t instanceof Array)for(var a=t.length;s<a;s++)u&&(u.index=s),o+=r(t[s],{data:u});else for(var f in t)t.hasOwnProperty(f)&&(u&&(u.key=f),o+=r(t[f],{data:u}),s++);return s===0&&(o=i(this)),o}),e.registerHelper("if",function(r,i){var s=t.call(r);return s===n&&(r=r.call(this)),!r||e.Utils.isEmpty(r)?i.inverse(this):i.fn(this)}),e.registerHelper("unless",function(t,n){var r=n.fn,i=n.inverse;return n.fn=i,n.inverse=r,e.helpers["if"].call(this,t,n)}),e.registerHelper("with",function(e,t){return t.fn(e)}),e.registerHelper("log",function(t,n){var r=n.data&&n.data.level!=null?parseInt(n.data.level,10):1;e.log(r,t)})}(this.Handlebars);var errorProps=["description","fileName","lineNumber","message","name","number","stack"];Handlebars.Exception=function(e){var t=Error.prototype.constructor.apply(this,arguments);for(var n=0;n<errorProps.length;n++)this[errorProps[n]]=t[errorProps[n]]},Handlebars.Exception.prototype=new Error,Handlebars.SafeString=function(e){this.string=e},Handlebars.SafeString.prototype.toString=function(){return this.string.toString()},function(){var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},t=/[&<>"'`]/g,n=/[&<>"'`]/,r=function(t){return e[t]||"&amp;"};Handlebars.Utils={escapeExpression:function(e){return e instanceof Handlebars.SafeString?e.toString():e==null||e===!1?"":n.test(e)?e.replace(t,r):e},isEmpty:function(e){return!e&&e!==0?!0:Object.prototype.toString.call(e)==="[object Array]"&&e.length===0?!0:!1}}}(),Handlebars.VM={template:function(e){var t={escapeExpression:Handlebars.Utils.escapeExpression,invokePartial:Handlebars.VM.invokePartial,programs:[],program:function(e,t,n){var r=this.programs[e];return n?Handlebars.VM.program(t,n):r?r:(r=this.programs[e]=Handlebars.VM.program(t),r)},programWithDepth:Handlebars.VM.programWithDepth,noop:Handlebars.VM.noop};return function(n,r){return r=r||{},e.call(t,Handlebars,n,r.helpers,r.partials,r.data)}},programWithDepth:function(e,t,n){var r=Array.prototype.slice.call(arguments,2);return function(n,i){return i=i||{},e.apply(this,[n,i.data||t].concat(r))}},program:function(e,t){return function(n,r){return r=r||{},e(n,r.data||t)}},noop:function(){return""},invokePartial:function(e,t,n,r,i,s){var o={helpers:r,partials:i,data:s};if(e===undefined)throw new Handlebars.Exception("The partial "+t+" could not be found");if(e instanceof Function)return e(n,o);if(!Handlebars.compile)throw new Handlebars.Exception("The partial "+t+" could not be compiled when running in runtime-only mode");return i[t]=Handlebars.compile(e,{data:s!==undefined}),i[t](n,o)}},Handlebars.template=Handlebars.VM.template,function(e,t,n){var r=function(e,t){var n="",r=t?t+"[":"",i=t?"]":"";for(var s in e)if(typeof e[s]=="object")for(var o in e[s])n+="&"+r+encodeURIComponent(s)+"."+encodeURIComponent(o)+i+"="+encodeURIComponent(e[s][o]);else n+="&"+r+encodeURIComponent(s)+i+"="+encodeURIComponent(e[s]);return n};t.registerHelper("flashVarsUrl",function(e){return r(e,"flashvars")}),t.registerHelper("flashVarsString",function(e){return r(e)}),t.registerHelper("elAttributes",function(e){var t="";for(var n in e)t+=" "+n+'="'+e[n]+'"';return t})}(this,this.Handlebars),function(){var e=Handlebars.template,t=Handlebars.templates=Handlebars.templates||{};t.auto=e(function(e,t,n,r,i){function s(e,t){var r="",i;return r+="&entry_id=",l=n.entryId,i=l||e.entryId,typeof i===p?i=i.call(e,{hash:{}}):i===v&&(i=d.call(e,"entryId",{hash:{}})),r+=m(i),r}function o(e,t){var r="",i;return r+="&cache_st=",l=n.cacheSt,i=l||e.cacheSt,typeof i===p?i=i.call(e,{hash:{}}):i===v&&(i=d.call(e,"cacheSt",{hash:{}})),r+=m(i),r}n=n||e.helpers;var u="",a,f,l,c,h=this,p="function",d=n.helperMissing,v=void 0,m=this.escapeExpression;u+='<script type="text/javascript" src="',l=n.scriptUrl,a=l||t.scriptUrl,typeof a===p?a=a.call(t,{hash:{}}):a===v&&(a=d.call(t,"scriptUrl",{hash:{}})),u+=m(a)+"?autoembed=true",l=n.entryId,a=l||t.entryId,f=n["if"],c=h.program(1,s,i),c.hash={},c.fn=c,c.inverse=h.noop,a=f.call(t,a,c);if(a||a===0)u+=a;u+="&playerId=",l=n.playerId,a=l||t.playerId,typeof a===p?a=a.call(t,{hash:{}}):a===v&&(a=d.call(t,"playerId",{hash:{}})),u+=m(a),l=n.cacheSt,a=l||t.cacheSt,f=n["if"],c=h.program(3,o,i),c.hash={},c.fn=c,c.inverse=h.noop,a=f.call(t,a,c);if(a||a===0)u+=a;u+="&width=",l=n.width,a=l||t.width,typeof a===p?a=a.call(t,{hash:{}}):a===v&&(a=d.call(t,"width",{hash:{}})),u+=m(a)+"&height=",l=n.height,a=l||t.height,typeof a===p?a=a.call(t,{hash:{}}):a===v&&(a=d.call(t,"height",{hash:{}})),u+=m(a),l=n.flashVars,a=l||t.flashVars,l=n.flashVarsUrl,f=l||t.flashVarsUrl,typeof f===p?a=f.call(t,a,{hash:{}}):f===v?a=d.call(t,"flashVarsUrl",a,{hash:{}}):a=f;if(a||a===0)u+=a;return u+='"></script>',u}),t.dynamic=e(function(e,t,n,r,i){n=n||e.helpers;var s="",o,u,a,f=this,l="function",c=n.helperMissing,h=void 0,p=this.escapeExpression;s+='<script type="text/javascript" src="',a=n.scriptUrl,o=a||t.scriptUrl,typeof o===l?o=o.call(t,{hash:{}}):o===h&&(o=c.call(t,"scriptUrl",{hash:{}})),s+=p(o)+'"></script>\n<div id="',a=n.playerId,o=a||t.playerId,typeof o===l?o=o.call(t,{hash:{}}):o===h&&(o=c.call(t,"playerId",{hash:{}})),s+=p(o)+'"',a=n.attributes,o=a||t.attributes,a=n.elAttributes,u=a||t.elAttributes,typeof u===l?o=u.call(t,o,{hash:{}}):u===h?o=c.call(t,"elAttributes",o,{hash:{}}):o=u;if(o||o===0)s+=o;s+='></div>\n<script type="text/javascript">\nkWidget.',a=n.embedMethod,o=a||t.embedMethod,typeof o===l?o=o.call(t,{hash:{}}):o===h&&(o=c.call(t,"embedMethod",{hash:{}})),s+=p(o)+"(",a=n.kWidgetObject,o=a||t.kWidgetObject,typeof o===l?o=o.call(t,{hash:{}}):o===h&&(o=c.call(t,"kWidgetObject",{hash:{}}));if(o||o===0)s+=o;return s+=");\n</script>",s}),t.legacy=e(function(e,t,n,r,i){function s(e,t){var r="",i;return r+='\n	<a rel="media:thumbnail" href="',l=n.entryMeta,i=l||e.entryMeta,i=i===null||i===undefined||i===!1?i:i.thumbnailUrl,typeof i===p?i=i.call(e,{hash:{}}):i===v&&(i=d.call(e,"entryMeta.thumbnailUrl",{hash:{}})),r+=m(i)+'"></a>\n	<span property="dc:description" content="',l=n.entryMeta,i=l||e.entryMeta,i=i===null||i===undefined||i===!1?i:i.description,typeof i===p?i=i.call(e,{hash:{}}):i===v&&(i=d.call(e,"entryMeta.description",{hash:{}})),r+=m(i)+'"></span>\n	<span property="media:title" content="',l=n.entryMeta,i=l||e.entryMeta,i=i===null||i===undefined||i===!1?i:i.name,typeof i===p?i=i.call(e,{hash:{}}):i===v&&(i=d.call(e,"entryMeta.name",{hash:{}})),r+=m(i)+'"></span>\n	<span property="media:width" content="',l=n.width,i=l||e.width,typeof i===p?i=i.call(e,{hash:{}}):i===v&&(i=d.call(e,"width",{hash:{}})),r+=m(i)+'"></span>\n	<span property="media:height" content="',l=n.height,i=l||e.height,typeof i===p?i=i.call(e,{hash:{}}):i===v&&(i=d.call(e,"height",{hash:{}})),r+=m(i)+'"></span>\n	<span property="media:type" content="application/x-shockwave-flash"></span>	\n	',r}function o(e,t){return'\n	<a href="http://corp.kaltura.com/products/video-platform-features">Video Platform</a>\n	<a href="http://corp.kaltura.com/Products/Features/Video-Management">Video Management</a> \n	<a href="http://corp.kaltura.com/Video-Solutions">Video Solutions</a>\n	<a href="http://corp.kaltura.com/Products/Features/Video-Player">Video Player</a>\n	'}n=n||e.helpers;var u="",a,f,l,c,h=this,p="function",d=n.helperMissing,v=void 0,m=this.escapeExpression;u+='<script type="text/javascript" src="',l=n.scriptUrl,a=l||t.scriptUrl,typeof a===p?a=a.call(t,{hash:{}}):a===v&&(a=d.call(t,"scriptUrl",{hash:{}})),u+=m(a)+'"></script>\n<object id="',l=n.playerId,a=l||t.playerId,typeof a===p?a=a.call(t,{hash:{}}):a===v&&(a=d.call(t,"playerId",{hash:{}})),u+=m(a)+'" name="',l=n.playerId,a=l||t.playerId,typeof a===p?a=a.call(t,{hash:{}}):a===v&&(a=d.call(t,"playerId",{hash:{}})),u+=m(a)+'" type="application/x-shockwave-flash" allowFullScreen="true" allowNetworking="all" allowScriptAccess="always" height="',l=n.height,a=l||t.height,typeof a===p?a=a.call(t,{hash:{}}):a===v&&(a=d.call(t,"height",{hash:{}})),u+=m(a)+'" width="',l=n.width,a=l||t.width,typeof a===p?a=a.call(t,{hash:{}}):a===v&&(a=d.call(t,"width",{hash:{}})),u+=m(a)+'" bgcolor="#000000"',l=n.attributes,a=l||t.attributes,l=n.elAttributes,f=l||t.elAttributes,typeof f===p?a=f.call(t,a,{hash:{}}):f===v?a=d.call(t,"elAttributes",a,{hash:{}}):a=f;if(a||a===0)u+=a;u+=' data="',l=n.swfUrl,a=l||t.swfUrl,typeof a===p?a=a.call(t,{hash:{}}):a===v&&(a=d.call(t,"swfUrl",{hash:{}})),u+=m(a)+'">\n	<param name="allowFullScreen" value="true" />\n	<param name="allowNetworking" value="all" />\n	<param name="allowScriptAccess" value="always" />\n	<param name="bgcolor" value="#000000" />\n	<param name="flashVars" value="',l=n.flashVars,a=l||t.flashVars,l=n.flashVarsString,f=l||t.flashVarsString,typeof f===p?a=f.call(t,a,{hash:{}}):f===v?a=d.call(t,"flashVarsString",a,{hash:{}}):a=f;if(a||a===0)u+=a;u+='" />\n	<param name="movie" value="',l=n.swfUrl,a=l||t.swfUrl,typeof a===p?a=a.call(t,{hash:{}}):a===v&&(a=d.call(t,"swfUrl",{hash:{}})),u+=m(a)+'" />\n	',l=n.includeSeoMetadata,a=l||t.includeSeoMetadata,f=n["if"],c=h.program(1,s,i),c.hash={},c.fn=c,c.inverse=h.noop,a=f.call(t,a,c);if(a||a===0)u+=a;l=n.includeKalturaLinks,a=l||t.includeKalturaLinks,f=n["if"],c=h.program(3,o,i),c.hash={},c.fn=c,c.inverse=h.noop,a=f.call(t,a,c);if(a||a===0)u+=a;return u+="\n</object>",u})}(),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){"use strict";if(this==null)throw new TypeError;var t=Object(this),n=t.length>>>0;if(n===0)return-1;var r=0;arguments.length>1&&(r=Number(arguments[1]),r!==r?r=0:r!==0&&r!==Infinity&&r!==-Infinity&&(r=(r>0||-1)*Math.floor(Math.abs(r))));if(r>=n)return-1;var i=r>=0?r:Math.max(n-Math.abs(r),0);for(;i<n;i++)if(i in t&&t[i]===e)return i;return-1}),Object.keys||(Object.keys=function(){var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],r=n.length;return function(i){if(typeof i!="object"&&typeof i!="function"||i===null)throw new TypeError("Object.keys called on non-object");var s=[];for(var o in i)e.call(i,o)&&s.push(o);if(t)for(var u=0;u<r;u++)e.call(i,n[u])&&s.push(n[u]);return s}}()),function(e,t){var n=function(e){this.init(e)};n.prototype={types:["auto","dynamic","thumb","legacy"],required:["widgetId","partnerId","uiConfId"],defaults:{embedType:"auto",playerId:"kaltura_player",protocol:"http",host:"www.kaltura.com",securedHost:"www.kaltura.com",widgetId:null,partnerId:null,cacheSt:null,uiConfId:null,entryId:null,entryMeta:{},width:400,height:330,attributes:{},flashVars:{},includeKalturaLinks:!0,includeSeoMetadata:!1},extend:function(e,t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n]);return e},isNull:function(e){return e.length&&e.length>0?!1:e.length&&e.length===0?!0:typeof e=="object"?Object.keys(e).length>0?!1:!0:!e},init:function(e){e=e||{};var n=this.defaults;if(typeof Handlebars===t)throw"Handlebars is not defined, please include Handlebars.js before this script";return typeof e=="object"&&(this.options=this.extend(e,this.defaults)),!this.config("widgetId")&&this.config("partnerId")&&this.config("widgetId","_"+this.config("partnerId")),this},config:function(e,n){return n===t&&typeof e=="string"&&this.options.hasOwnProperty(e)?this.options[e]:e===t&&n===t?this.options:(typeof e=="string"&&n!==t&&(this.options[e]=n),null)},checkRequiredParams:function(e){var t=this.required.length,n=0;for(n;n<t;n++)if(this.isNull(e[this.required[n]]))throw"Missing required parameter: "+this.required[n]},checkValidType:function(e){var t=this.types.indexOf(e)!==-1?!0:!1;if(!t)throw"Embed type: "+e+" is not valid. Available types: "+this.types.join(",")},getTemplate:function(e){return e=e=="thumb"?"dynamic":e,e&&Handlebars.templates&&Handlebars.templates[e]?Handlebars.templates[e]:null},isKWidgetEmbed:function(e){return e=="dynamic"||e=="thumb"?!0:!1},getHost:function(e){return e.protocol==="http"?e.host:e.securedHost},getScriptUrl:function(e){return e.protocol+"://"+this.getHost(e)+"/p/"+e.partnerId+"/sp/"+e.partnerId+"00/embedIframeJs/uiconf_id/"+e.uiConfId+"/partner_id/"+e.partnerId},getSwfUrl:function(e){var t=e.cacheSt?"/cache_st/"+e.cacheSt:"",n=e.entryId?"/entry_id/"+e.entryId:"";return e.protocol+"://"+this.getHost(e)+"/index.php/kwidget"+t+"/wid/"+e.widgetId+"/uiconf_id/"+e.uiConfId+n},getAttributes:function(e){if(!e)return{};var t={};return this.isKWidgetEmbed(e.embedType)&&(t.style="width: "+e.width+"px; height: "+e.height+"px;"),e.embedType=="legacy"&&e.includeSeoMetadata&&(t["xmlns:dc"]="http://purl.org/dc/terms/",t["xmlns:media"]="http://search.yahoo.com/searchmonkey/media/",t.rel="media:video",t.resource=this.getSwfUrl(e)),e.attributes=this.extend(e.attributes,t),e.attributes},getEmbedObject:function(e){var t={targetId:e.playerId,wid:e.widgetId,uiconf_id:e.uiConfId,flashvars:e.flashVars};return e.cacheSt&&(t.cache_st=cacheSt),e.entryId&&(t.entry_id=e.entryId),JSON.stringify(t,null,2)},getCode:function(e){e=e||{},e=this.extend(e,this.config()),!e.widgetId&&e.partnerId&&(e.widgetId="_"+e.partnerId),this.checkRequiredParams(e),this.checkValidType(e.embedType);var t=this.getTemplate(e.embedType);if(!t)throw"Template: "+e.embedType+" is not defined as Handlebars template";var n={scriptUrl:this.getScriptUrl(e),attributes:this.getAttributes(e)};return e.embedType==="legacy"&&(n.swfUrl=this.getSwfUrl(e)),this.isKWidgetEmbed(e.embedType)&&(n.embedMethod=e.embedType=="dynamic"?"embed":"thumbEmbed",n.kWidgetObject=this.getEmbedObject(e)),n=this.extend(n,e),t(n)}},e.kEmbedCodeGenerator=n}(this);